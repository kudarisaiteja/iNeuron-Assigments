CREATE DATABASE TEJSHOPPINGMALL;
USE DATABASE TEJSHOPPINGMALL;

CREATE or replace TABLE GROCERIES(
  PRODUCT_NAME VARCHAR(50),
  QUANTITY INT,
  UNIT_PRICE DECIMAL NOT NULL);
  
  INSERT INTO GROCERIES(PRODUCT_NAME,QUANTITY,UNIT_PRICE) VALUES('MILK',3,10);
  INSERT INTO GROCERIES(PRODUCT_NAME,QUANTITY,UNIT_PRICE) VALUES('BREAD',7, 3); 
  INSERT INTO GROCERIES(PRODUCT_NAME,QUANTITY,UNIT_PRICE) VALUES( 'BREAD',5, 2);
  
  SELECT * FROM  GROCERIES;
  
 
  --total_price using group by
select PRODUCT_NAME, sum(QUANTITY*UNIT_PRICE) as total_price From GROCERIES group by PRODUCT_NAME order by PRODUCT_NAME desc;

	 --total_price using partition by
select distinct PRODUCT_NAME, sum(QUANTITY*UNIT_PRICE) over(partition by PRODUCT_NAME) as total_price from GROCERIES;


-------------------------------------------------------------------------------------------------------------------------------------------------------------------
  
  
  SELECT UNIT_PRICE, PRODUCT_NAME, QUANTITY FROM GROCERIES ORDER BY 1;
  
  SELECT AVG(UNIT_PRICE) FROM  GROCERIES;
  SELECT MAX(QUANTITY) FROM  GROCERIES;  
  SELECT MIN(QUANTITY) FROM  GROCERIES;  
  SELECT MAX(PRODUCT_NAME) FROM  GROCERIES;  
  SELECT MIN(PRODUCT_NAME) FROM  GROCERIES;  

 SELECT * FROM GROCERIES ORDER BY PRODUCT_NAME;
  SELECT * FROM GROCERIES ORDER BY UNIT_PRICE;
   SELECT * FROM GROCERIES ORDER BY QUANTITY;
   
    SELECT * FROM GROCERIES ORDER BY QUANTITY LIMIT 1;
    SELECT * FROM GROCERIES ORDER BY UNIT_PRICE LIMIT 1;
    SELECT * FROM GROCERIES ORDER BY  PRODUCT_NAME LIMIT 7;

   select * from PRODUCT_NAME ,UNIT_PRICE, QUANTITY;
   
  show QUANTITY FROM GROCERIES;
  
  select * from GROCERIES where min(QUANTITY);
  
   select PRODUCT_NAME, UNIT_PRICE FROM GROCERIES WHERE UNIT_PRICE >= 20;
      select PRODUCT_NAME, UNIT_PRICE FROM GROCERIES WHERE UNIT_PRICE <= 20;

   
 SELECT * FROM GROCERIES WHERE UNIT_PRICE IN (SELECT MIN(UNIT_PRICE) FROM GROCERIES);
  SELECT * FROM GROCERIES WHERE QUANTITY IN (SELECT MIN(QUANTITY) FROM GROCERIES);


  SELECT * FROM  GROCERIES;   

SELECT *FROM GROCERIES WHERE QUANTITY = (SELECT MIN ( QUANTITY) FROM  GROCERIES);
   
 SELECT *FROM GROCERIES WHERE QUANTITY = (SELECT MAX ( QUANTITY) FROM  GROCERIES);

SELECT * FROM GROCERIES ORDER BY UNIT_PRICE DESC ;
SELECT * FROM GROCERIES ORDER BY QUANTITY DESC LIMIT 4;


SELECT  PRODUCT_NAME, UNIT_PRICE,  QUANTITY FROM GROCERIES ;

SELECT  PRODUCT_NAME, UNIT_PRICE FROM GROCERIES ;